# Travis CI
#
#

sudo: required
dist: trusty
language: generic
python:
  - "2.7"

env:
  matrix:
    - "TESTDIR=Ruby/grape"
    - "TESTDIR=Ruby/ngx_mruby"
    - "TESTDIR=Ruby/padrino"
    - "TESTDIR=Ruby/rack"
    - "TESTDIR=Ruby/rails"
    - "TESTDIR=Ruby/rails-stripped"
    - "TESTDIR=Ruby/sinatra"
    - "TESTDIR=Ruby/sinatra-sequel"

before_script:
  # travis_clean.sh takes care of some services that are baked into the travis
  # build. Using language: generic gets us an ubuntu build with fewer services,
  # but includes database installs, ruby and rvm installs, and others that interfere
  # with running the suite in a clean ubuntu install.
  - source ./toolset/travis/travis_clean.sh

  # travis_setup.sh runs all the same commands you would run if you were setting up
  # a development environment via:
  # http://frameworkbenchmarks.readthedocs.io/en/latest/Development/Installation-Guide/
  - source ./toolset/travis/travis_setup.sh

script:
  # run-ci.py runs the diffing to see if travis needs to test this framework. Ideally/eventually,
  # we'd like to try and do the diffing before travis_clean & setup.
  # This will run the tests exactly as you would in your own vm:
  # ./toolset/run-tests.py --mode verify --test (all the valid tests for this framework)
  - ./toolset/run-ci.py verify "$TESTDIR"

cache:
  directories:
    - $HOME/.m2/repository
    - $HOME/.cache/pip
