language: python
python: 
  - "2.7"

env:
  matrix:

    # Group tests to logically break up travis-CI build.
    # The goal is to minimize the number of "TESTDIR=..." lines, as 
    # each line adds a job to the travis build. The main grouping
    # is by language, but travis jobs have a 50 minute limit so 
    # we occasionally have to group more precisely than language.
    # Fewer jobs per build == faster complete build and fewer 
    # travis-ci resources consumed, so it's important to hit as 
    # close to the 50 minute limit as is possible
    #
    # Each TESTDIR is interpreted as a regex and is not escaped 
    # before use 
    #  
    - "TESTDIR=C"
    - "TESTDIR=CSharp"
    # C++: cpoll_cppsp,treefrog,ULib
    - "TESTDIR=C++\\\\/[ctU]"
    # C++: wt
    - "TESTDIR=C++\\\\/wt"
    - "TESTDIR=Clojure"
    - "TESTDIR=Dart"
    - "TESTDIR=Elixir"
    - "TESTDIR=Erlang"
    - "TESTDIR=Go"
    - "TESTDIR=Groovy"
    - "TESTDIR=Haskell"
    # Java: activeweb to dropwizard
    - "TESTDIR=Java\\\\/[a-d]"
    # Java: gemini to ninja
    - "TESTDIR=Java\\\\/[g-n]"
    # Java: play to restexpress
    - "TESTDIR=Java\\\\/[p-r]"
    # Java: servlet to tapestry
    - "TESTDIR=Java\\\\/[st]"
    # Java: undertow to wildfly
    - "TESTDIR=Java\\\\/[u-w]"
    - "TESTDIR=JavaScript"
    - "TESTDIR=Lua"
    - "TESTDIR=Nim"
    - "TESTDIR=Perl"
    - "TESTDIR=PHP"
    - "TESTDIR=Python"
    - "TESTDIR=Racket"
    - "TESTDIR=Ruby"
    - "TESTDIR=Scala"
    - "TESTDIR=Ur"

before_install:
  # Need to install python modules before using 
  # python
  - pip install -r config/python_requirements.txt

  # Configure Travis-CI build environment for TFB
  #   e.g. setup databases, users, etc
  - ./toolset/run-ci.py cisetup "$TESTDIR"

addons:
  postgresql: "9.3" 

install:
  # Install prerequisites
  - ./toolset/run-ci.py prereq "$TESTDIR"
  
  # Install software for this framework  
  - ./toolset/run-ci.py install "$TESTDIR"
   
script: 
  # Pick one test in this directory and verify
  - time ./toolset/run-ci.py verify "$TESTDIR"
  
