#
# Services needed for benchmarking. This file will not run on its own, it needs to be started after
# root's `docker-compose.yml`. To do so, execute the following command from the root directory:
#
#    docker-compose -f docker-compose.yml -f hexagon_benchmark/docker-compose.yml up -d
#

version: '3'

services:

  hexagon:
    build:
      context: .
      dockerfile: hexagon.dockerfile
    ports:
      - 8010:9090

  hexagon_jetty_postgresql:
    build:
      context: .
      dockerfile: hexagon-jetty-postgresql.dockerfile
    ports:
      - 8020:9090

  hexagon_resin_mongodb:
    build:
      context: .
      dockerfile: hexagon-resin-mongodb.dockerfile
    ports:
      - 8030:8080

  hexagon_resin_postgresql:
    build:
      context: .
      dockerfile: hexagon-resin-postgresql.dockerfile
    ports:
      - 8040:8080

  postgresql:
    image: postgres:12.2
    environment:
      POSTGRES_USER: benchmarkdbuser
      POSTGRES_PASSWORD: benchmarkdbpass
    volumes:
      - ./data/postgresql.sql:/docker-entrypoint-initdb.d/db.sql:ro
    ports:
      - 5432:5432

  mongodb:
    image: mongo:4.2
    volumes:
      - ./data/mongodb.js:/docker-entrypoint-initdb.d/mongodb.js:ro
    ports:
      - 27017:27017
